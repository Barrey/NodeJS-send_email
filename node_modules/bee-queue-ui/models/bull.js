'use strict';

var _ = require("lodash");
var Promise = require('bluebird');
var q = require('q');
var Queue = require('bee-queue');

var createQueue = _.memoize(
  function( queue, port, host, options ){
    return Queue( queue, port, host, options);
  },
  function(queue, port, host, options){
    return queue;
  }
);

var createJob = function createJob(redisOptions, queueName, payload, done){
  var options = redisOptions.options || {};
  if(redisOptions.password){
    options.auth_pass = redisOptions.password;
  }
  var q = Queue(queueName);//, redisOptions.port, redisOptions.host, options);
  console.log('Queue', q);
  var job = q.createJob(payload).save();
  console.log('newjob', job);
};

module.exports.createJob = createJob; // Creates a job
